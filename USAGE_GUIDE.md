# FashionXG å®Œæ•´ä½¿ç”¨æŒ‡å—

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    äº‘ç«¯æœåŠ¡å™¨                                 â”‚
â”‚              https://design.chermz112.xyz                   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Webç•Œé¢    â”‚    â”‚  FastAPI     â”‚    â”‚   SQLite     â”‚  â”‚
â”‚  â”‚  (æµè§ˆå›¾ç‰‡)   â”‚    â”‚  (APIæ¥å£)   â”‚    â”‚   (æ•°æ®åº“)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†‘                   â†‘â†“                              â”‚
â”‚     è®¾è®¡å¸ˆæµè§ˆ            APIè°ƒç”¨                            â”‚
â”‚     ç‚¹èµ/ç‚¹è¸©                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
                         ç½‘ç»œé€šä¿¡
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Mac æœ¬åœ°ç«¯                                â”‚
â”‚         /Users/sunzemuzi/Downloads/fashionxg-local          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ comfy_bridge â”‚    â”‚   ComfyUI    â”‚    â”‚  åå¥½é…ç½®     â”‚  â”‚
â”‚  â”‚  (æ¡¥æ¥è„šæœ¬)   â”‚ â†’  â”‚  (AIå¤„ç†)    â”‚    â”‚   (JSON)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                 â”‚
â”‚                    WD14æ ‡ç­¾ + å®¡ç¾è¯„åˆ†                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Webç«¯æ“ä½œï¼ˆè®¾è®¡å¸ˆï¼‰

### è®¿é—®åœ°å€
- **ä¸»é¡µ**: https://design.chermz112.xyz
- **APIæ–‡æ¡£**: https://design.chermz112.xyz/docs

### æ—¥å¸¸ä½¿ç”¨æµç¨‹

1. **æµè§ˆå›¾ç‰‡**
   - æ‰“å¼€ https://design.chermz112.xyz
   - ç€‘å¸ƒæµå±•ç¤ºæ‰€æœ‰å›¾ç‰‡

2. **ç‚¹èµ/ç‚¹è¸©**
   - å–œæ¬¢çš„å›¾ç‰‡ â†’ ç‚¹èµ âœ…
   - ä¸å–œæ¬¢çš„å›¾ç‰‡ â†’ ç‚¹è¸© âŒ
   - è¿™äº›åé¦ˆä¼šè¢«Macç«¯ç”¨æ¥ä¼˜åŒ–ç­›é€‰

3. **æŸ¥çœ‹ç»Ÿè®¡**
   - API: https://design.chermz112.xyz/api/stats
   - å¯ä»¥çœ‹åˆ°å¤„ç†è¿›åº¦

### Webç«¯ä¸éœ€è¦é¢å¤–æ“ä½œ
- æœåŠ¡å™¨å·²ç»åœ¨è¿è¡Œ
- APIå·²ç»é…ç½®å¥½
- åªéœ€è¦æ­£å¸¸ä½¿ç”¨å³å¯

---

## ğŸ Macæœ¬åœ°ç«¯æ“ä½œ

### æ–‡ä»¶ä½ç½®
```
/Users/sunzemuzi/Downloads/fashionxg-local/
â”œâ”€â”€ comfy_bridge.py          # ä¸»ç¨‹åº
â”œâ”€â”€ update_preference_lib.py # æ›´æ–°åå¥½é…ç½®
â”œâ”€â”€ fashion_tagger_api.json  # ComfyUIå·¥ä½œæµ
â”œâ”€â”€ preference_profile.json  # åå¥½é…ç½®
â”œâ”€â”€ run_lazy.sh              # åå°è¿è¡Œè„šæœ¬
â”œâ”€â”€ venv/                    # Pythonè™šæ‹Ÿç¯å¢ƒ
â””â”€â”€ .env                     # é…ç½®æ–‡ä»¶
```

### é¦–æ¬¡ä½¿ç”¨è®¾ç½®

#### æ­¥éª¤1: å¯åŠ¨ComfyUI
```bash
cd ~/ComfyUI
source venv/bin/activate
python main.py --listen 127.0.0.1 --port 8188
```
ä¿æŒè¿™ä¸ªç»ˆç«¯çª—å£æ‰“å¼€ï¼Œæˆ–è€…åå°è¿è¡Œï¼š
```bash
nohup python main.py --listen 127.0.0.1 --port 8188 > /tmp/comfyui.log 2>&1 &
```

#### æ­¥éª¤2: æ‰‹åŠ¨è¿è¡Œä¸€æ¬¡æµ‹è¯•
```bash
cd /Users/sunzemuzi/Downloads/fashionxg-local
source venv/bin/activate
python comfy_bridge.py --once --batch-size 5
```

å¦‚æœçœ‹åˆ° "Batch complete: 5/5 images processed successfully" å°±è¯´æ˜æ­£å¸¸ã€‚

---

## ğŸ”„ æ—¥å¸¸ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: æ‰‹åŠ¨è¿è¡Œï¼ˆæ¨èæ–°æ‰‹ï¼‰

æ¯æ¬¡æƒ³å¤„ç†å›¾ç‰‡æ—¶ï¼Œæ‰“å¼€ç»ˆç«¯è¿è¡Œï¼š
```bash
cd /Users/sunzemuzi/Downloads/fashionxg-local
source venv/bin/activate

# å…ˆç¡®ä¿ComfyUIåœ¨è¿è¡Œ
curl -s http://127.0.0.1:8188 || (cd ~/ComfyUI && source venv/bin/activate && nohup python main.py --listen 127.0.0.1 --port 8188 > /tmp/comfyui.log 2>&1 &)

# å¤„ç†100å¼ å›¾ç‰‡
python comfy_bridge.py --once --batch-size 100
```

### æ–¹å¼2: åå°æŒç»­è¿è¡Œ

å¯åŠ¨åä¼šæ¯å°æ—¶è‡ªåŠ¨å¤„ç†ä¸€æ‰¹ï¼š
```bash
cd /Users/sunzemuzi/Downloads/fashionxg-local
./run_lazy.sh
```

æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
tail -f /tmp/fashionxg.log
```

åœæ­¢ï¼š
```bash
pkill -f comfy_bridge.py
pkill -f "python main.py"
```

### æ–¹å¼3: å¼€æœºè‡ªåŠ¨è¿è¡Œï¼ˆLazyæ¨¡å¼ï¼‰

å®‰è£…åä¼šï¼š
- ç™»å½•Macè‡ªåŠ¨å¯åŠ¨
- ç†„å±æ—¶è‡ªåŠ¨æš‚åœï¼ˆçœç”µï¼‰
- äº®å±æ—¶è‡ªåŠ¨ç»§ç»­
- å…³æœºè‡ªåŠ¨åœæ­¢

```bash
# å®‰è£…
cp ~/Downloads/fashionxg-local/com.fashionxg.bridge.plist ~/Library/LaunchAgents/
launchctl load ~/Library/LaunchAgents/com.fashionxg.bridge.plist

# å¸è½½
launchctl unload ~/Library/LaunchAgents/com.fashionxg.bridge.plist
rm ~/Library/LaunchAgents/com.fashionxg.bridge.plist
```

---

## ğŸ“‹ å®Œæ•´å·¥ä½œæµç¨‹

### æ¯æ—¥æµç¨‹

```
1. Macå¼€æœº/äº®å±
      â†“
2. ComfyUIè‡ªåŠ¨å¯åŠ¨ï¼ˆæˆ–æ‰‹åŠ¨å¯åŠ¨ï¼‰
      â†“
3. Bridgeè„šæœ¬è¿è¡Œ
      â†“
4. ä»æœåŠ¡å™¨æ‹‰å–å¾…å¤„ç†å›¾ç‰‡
      â†“
5. ComfyUIå¤„ç†ï¼ˆæå–æ ‡ç­¾+è¯„åˆ†ï¼‰
      â†“
6. åº”ç”¨è¿‡æ»¤é€»è¾‘ï¼ˆé»‘åå•ã€åå¥½åŒ¹é…ï¼‰
      â†“
7. ç»“æœä¸Šä¼ åˆ°æœåŠ¡å™¨
      â†“
8. ä¼‘æ¯60åˆ†é’Ÿï¼Œé‡å¤æ­¥éª¤4
```

### åå¥½æ›´æ–°æµç¨‹ï¼ˆå¯é€‰ï¼Œæ¯å‘¨ä¸€æ¬¡ï¼‰

å½“ä½ åœ¨Webä¸Šç§¯ç´¯äº†è¶³å¤Ÿçš„ç‚¹èµ/ç‚¹è¸©åï¼š
```bash
cd /Users/sunzemuzi/Downloads/fashionxg-local
source venv/bin/activate
python update_preference_lib.py
```

è¿™ä¼šæ›´æ–° `preference_profile.json`ï¼Œè®©ç­›é€‰æ›´ç¬¦åˆä½ çš„å£å‘³ã€‚

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### å¯åŠ¨ComfyUI
```bash
cd ~/ComfyUI && source venv/bin/activate
python main.py --listen 127.0.0.1 --port 8188
```

### å¤„ç†å›¾ç‰‡ï¼ˆä¸€æ¬¡æ€§ï¼‰
```bash
cd ~/Downloads/fashionxg-local && source venv/bin/activate
python comfy_bridge.py --once --batch-size 100
```

### æŒç»­å¤„ç†ï¼ˆå‰å°ï¼‰
```bash
python comfy_bridge.py --batch-size 50 --sleep 60
```

### æŸ¥çœ‹å¤„ç†æ—¥å¿—
```bash
tail -f /tmp/fashionxg.log
```

### æŸ¥çœ‹ComfyUIæ—¥å¿—
```bash
tail -f /tmp/comfyui.log
```

### æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
```bash
curl -s https://design.chermz112.xyz/api/stats | python3 -m json.tool
```

### åœæ­¢æ‰€æœ‰è¿›ç¨‹
```bash
pkill -f comfy_bridge.py
pkill -f "python main.py"
```

---

## â“ å¸¸è§é—®é¢˜

### Q: ComfyUIå¯åŠ¨å¤±è´¥ï¼Ÿ
```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
lsof -i :8188
# å¦‚æœè¢«å ç”¨ï¼Œæ€æ‰è¿›ç¨‹
pkill -f "python main.py"
```

### Q: å¤„ç†é€Ÿåº¦å¾ˆæ…¢ï¼Ÿ
- é¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½æ¨¡å‹ï¼Œä¼šæ¯”è¾ƒæ…¢
- ä¹‹åæ¯å¼ å›¾çº¦3ç§’

### Q: å¦‚ä½•æŸ¥çœ‹å·²å¤„ç†å¤šå°‘å¼ ï¼Ÿ
```bash
curl -s https://design.chermz112.xyz/api/stats
```

### Q: æƒ³ä¿®æ”¹å¤„ç†é—´éš”ï¼Ÿ
ç¼–è¾‘ `run_lazy.sh`ï¼Œä¿®æ”¹ `sleep 3600`ï¼ˆç§’æ•°ï¼‰

### Q: æƒ³ä¿®æ”¹æ¯æ‰¹å¤„ç†æ•°é‡ï¼Ÿ
ä¿®æ”¹ `--batch-size 50` å‚æ•°

---

## ğŸ“Š æ•°æ®æµå‘

```
Pinterestçˆ¬è™« â†’ æœåŠ¡å™¨æ•°æ®åº“(1479å¼ )
                    â†“
              å¾…å¤„ç†é˜Ÿåˆ—(process_status=0)
                    â†“
              Macæœ¬åœ°æ‹‰å–
                    â†“
              ComfyUIå¤„ç†
              - WD14: æå–æ ‡ç­¾
              - Aesthetic: è¯„åˆ†
                    â†“
              é€»è¾‘è¿‡æ»¤
              - é»‘åå•æ£€æŸ¥
              - åå¥½åŒ¹é…
                    â†“
              ä¸Šä¼ ç»“æœ(process_status=1)
                    â†“
              Webå±•ç¤ºç»™è®¾è®¡å¸ˆ
                    â†“
              è®¾è®¡å¸ˆç‚¹èµ/ç‚¹è¸©
                    â†“
              æ›´æ–°åå¥½é…ç½®
                    â†“
              ä¼˜åŒ–ç­›é€‰é€»è¾‘ï¼ˆå¾ªç¯ï¼‰
```

---

## âœ… æ£€æŸ¥æ¸…å•

### é¦–æ¬¡ä½¿ç”¨å‰ç¡®è®¤
- [ ] ComfyUIå·²å®‰è£… (`ls ~/ComfyUI`)
- [ ] è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»º (`ls ~/Downloads/fashionxg-local/venv`)
- [ ] æœåŠ¡å™¨å¯è®¿é—® (`curl https://design.chermz112.xyz/api/stats`)

### æ¯æ¬¡ä½¿ç”¨å‰ç¡®è®¤
- [ ] ComfyUIæ­£åœ¨è¿è¡Œ (`curl http://127.0.0.1:8188`)
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸

---

**å°±è¿™ä¹ˆç®€å•ï¼**

æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼š
1. å¯åŠ¨ComfyUI
2. è¿è¡Œ `python comfy_bridge.py --once --batch-size 100`
3. å»Webä¸Šçœ‹ç»“æœã€ç‚¹èµç‚¹è¸©
